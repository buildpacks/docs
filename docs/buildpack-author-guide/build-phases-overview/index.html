<!doctype html>
<html lang="en">

<head>
  


<meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="We work through a full example of building a &amp;ldquo;hello world&amp;rdquo; NodeJs web application. In the example we run pack on the NodeJS application to produce an application image. We assume that we…"/>
<link rel="canonical" content="https://buildpacks.io/docs/buildpack-author-guide/build-phases-overview/">
<link rel="icon" type="image/png" href="/images/favicon.png">






<meta property="og:title" content="Overview of Buildpacks Phases · Cloud Native Buildpacks">
<meta property="og:type" content="website">
<meta property="og:url" content="https://buildpacks.io/docs/buildpack-author-guide/build-phases-overview/">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Cloud Native Buildpacks">
<meta property="og:description" content="We work through a full example of building a &amp;ldquo;hello world&amp;rdquo; NodeJs web application. In the example we run pack on the NodeJS application to produce an application image. We assume that we…">
<meta property="og:type" content="article">
<meta property="og:image" content="https://buildpacks.io/images/buildpacks-social-card.jpg">
<meta property="og:image:alt" content="Buildpacks project logo">
<meta property="og:image:type" content="image/jpeg">






<meta property="twitter:title" content="Overview of Buildpacks Phases · Cloud Native Buildpacks">
<meta property="twitter:card" content="summary">
<meta property="twitter:image" content="https://buildpacks.io/images/buildpacks-social-card-square.jpg">
<meta property="twitter:image:alt" content="Buildpacks project logo">
<meta property="twitter:site" content="@buildpacks_io">
<meta property="twitter:creator" content="@buildpacks_io">

  <script
    src="https://cdn.jsdelivr.net/combine/npm/axios@0.21.0,npm/jquery@3.5.1,npm/bootstrap@4.5.3,npm/fullcalendar@5.4.0,npm/jquery-replacetext@1.1.0/replacetext.min.js"></script>


  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.1/css/all.min.css"
    crossorigin="anonymous">
  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/combine/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css,npm/fullcalendar@5.4.0/main.min.css"
    crossorigin="anonymous">
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono|Source+Sans+Pro:400,400i,600" rel="stylesheet">
  
  <link rel="stylesheet" href="https://buildpacks.io/scss/site.css" integrity="" media="screen">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-CJLSR4FQXL"></script>
  <link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/asciinema-player/2.6.1/asciinema-player.min.css"
    integrity="sha512-tv24MiwP+0CRCL80VsmJYPl/xDD2tdlDMz9fhNCIAQ6UPrj6Kh/57hOt9A4YnoNDKH5QDxJqGhtt9NPW2sgQeg=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer">
  <style type="text/css">
    .asciinema-theme-asciinema .fg-15 {
        color: #6a2929;
    }
    .asciinema-theme-asciinema .asciinema-terminal {
        color: #888888;
    }
  </style>

  <script>
    $(function () {
      $('h1[id], h2[id], h3[id], h4[id], h5[id]').not(':has(a)').each(function () {
        this.innerHTML =
          `<a href="#${this.id}" class="h-anchor">
            ${this.innerHTML} <i class="fas fa-link icon" aria-label="Anchor"></i>
          </a>`;
      });

      if ($('input#search').length > 0) {
        docsearch({
          apiKey: '5c00a51f166dab99e1cc6e0a9976e9f9',
          indexName: 'buildpacks',
          inputSelector: 'input#search',
          debug: false
        });
      }
    });

    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-CJLSR4FQXL');
  </script>

  <title>Overview of Buildpacks Phases · Cloud Native Buildpacks</title>
</head>

<body>
  <header class="container px-0">
  <nav class="navbar navbar-expand-lg navbar-light">
    <a href="https://buildpacks.io/" class="logo navbar-brand"><img src="/images/buildpacks-logo.svg"
        alt="Buildpacks Logo"></a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
      <ul class="navbar-nav">
        
        
        
        <li class="nav-item mr-lg-4 text-center text-lg-left ">
          <a class="nav-link py-2 py-lg-0 px-1"  href="/features">
            Features
          </a>
        </li>
        
        
        <li class="nav-item mr-lg-4 text-center text-lg-left ">
          <a class="nav-link py-2 py-lg-0 px-1"  href="/community">
            Community
          </a>
        </li>
        
        
        <li class="nav-item mr-lg-4 text-center text-lg-left ">
          <a class="nav-link py-2 py-lg-0 px-1" target='_blank'  href="https://medium.com/buildpacks">
            Blog
          </a>
        </li>
        
        
        <li class="nav-item mr-lg-4 text-center text-lg-left ">
          <a class="nav-link py-2 py-lg-0 px-1" target='_blank'  href="https://registry.buildpacks.io/">
            Registry
          </a>
        </li>
        
        <li class="nav-item text-center d-lg-none">
          <a class="nav-link py-2 px-1" href="/docs">Docs</a>
        </li>
        <li class="nav-item text-center d-lg-none">
          <a class="nav-link py-2 px-1" target='_blank' rel="noopener noreferrer" href="https://github.com/buildpacks">GitHub</a>
        </li>
      </ul>

      <a class="button-light mr-3 d-none d-lg-block" href="/docs"><i class="far fa-file-alt mr-2"></i>Docs</a>
      <a class="github-button icon-button bg-blue button d-none d-lg-flex" href="https://github.com/buildpacks">GitHub</a>
    </div>
  </nav>
</header>

  

<div class='docs'>
  <div class="container">
    <div class='row'>
      <div class='col-md-3 docs-sidebar'>
        <nav class='sidebar'>
  <form class="pt-1 pb-3 pl-2 pr-3 border-bottom">
    <input id="search" class="form-control" type="search" placeholder="Search..." aria-label="Search">
  </form>
  <ul>
    <li data-nav-id="/docs/" class="dd-item depth-0">
      <a href="/docs/">Getting Started</a>
      <ul class="ml-2">
        
<li data-nav-id="/docs/app-journey/" class="dd-item depth-1 collapse">
  <a href="/docs/app-journey/">An App&rsquo;s Brief Journey from Source to Image</a>
</li>
      </ul>
    </li>
<li data-nav-id="/docs/concepts/" class="dd-item depth-0 haschildren">
  <a href="/docs/concepts/">Concepts</a>
  <ul class="ml-2">
<li data-nav-id="/docs/concepts/components/" class="dd-item depth-1 collapse haschildren">
  <a href="/docs/concepts/components/">Components</a>
  <ul class="ml-2">
<li data-nav-id="/docs/concepts/components/builder/" class="dd-item depth-2">
  <a href="/docs/concepts/components/builder/">Builder</a>
</li>
<li data-nav-id="/docs/concepts/components/buildpack/" class="dd-item depth-2">
  <a href="/docs/concepts/components/buildpack/">Buildpack</a>
</li>
<li data-nav-id="/docs/concepts/components/buildpack-group/" class="dd-item depth-2">
  <a href="/docs/concepts/components/buildpack-group/">Buildpack Group</a>
</li>
<li data-nav-id="/docs/concepts/components/lifecycle/" class="dd-item depth-2 haschildren">
  <a href="/docs/concepts/components/lifecycle/">Lifecycle</a>
  <ul class="ml-2">
<li data-nav-id="/docs/concepts/components/lifecycle/analyze/" class="dd-item depth-3 collapse">
  <a href="/docs/concepts/components/lifecycle/analyze/">Analyze</a>
</li>
<li data-nav-id="/docs/concepts/components/lifecycle/detect/" class="dd-item depth-3 collapse">
  <a href="/docs/concepts/components/lifecycle/detect/">Detect</a>
</li>
<li data-nav-id="/docs/concepts/components/lifecycle/restore/" class="dd-item depth-3 collapse">
  <a href="/docs/concepts/components/lifecycle/restore/">Restore</a>
</li>
<li data-nav-id="/docs/concepts/components/lifecycle/build/" class="dd-item depth-3 collapse">
  <a href="/docs/concepts/components/lifecycle/build/">Build</a>
</li>
<li data-nav-id="/docs/concepts/components/lifecycle/export/" class="dd-item depth-3 collapse">
  <a href="/docs/concepts/components/lifecycle/export/">Export</a>
</li>
<li data-nav-id="/docs/concepts/components/lifecycle/create/" class="dd-item depth-3 collapse">
  <a href="/docs/concepts/components/lifecycle/create/">Create</a>
</li>
<li data-nav-id="/docs/concepts/components/lifecycle/launch/" class="dd-item depth-3 collapse">
  <a href="/docs/concepts/components/lifecycle/launch/">Launch</a>
</li>
<li data-nav-id="/docs/concepts/components/lifecycle/rebase/" class="dd-item depth-3 collapse">
  <a href="/docs/concepts/components/lifecycle/rebase/">Rebase</a>
</li>
  </ul>
</li>
<li data-nav-id="/docs/concepts/components/platform/" class="dd-item depth-2">
  <a href="/docs/concepts/components/platform/">Platform</a>
</li>
<li data-nav-id="/docs/concepts/components/stack/" class="dd-item depth-2">
  <a href="/docs/concepts/components/stack/">Stack</a>
</li>
  </ul>
</li>
<li data-nav-id="/docs/concepts/operations/" class="dd-item depth-1 collapse haschildren">
  <a href="/docs/concepts/operations/">Operations</a>
  <ul class="ml-2">
<li data-nav-id="/docs/concepts/operations/build/" class="dd-item depth-2">
  <a href="/docs/concepts/operations/build/">Build</a>
</li>
<li data-nav-id="/docs/concepts/operations/rebase/" class="dd-item depth-2">
  <a href="/docs/concepts/operations/rebase/">Rebase</a>
</li>
  </ul>
</li>
  </ul>
</li>
<li data-nav-id="/docs/features/" class="dd-item depth-0 haschildren">
  <a href="/docs/features/">Features</a>
  <ul class="ml-2">
<li data-nav-id="/docs/features/experimental/" class="dd-item depth-1 collapse haschildren">
  <a href="/docs/features/experimental/">Experimental</a>
  <ul class="ml-2">
<li data-nav-id="/docs/features/experimental/export-to-oci-layout/" class="dd-item depth-2 collapse">
  <a href="/docs/features/experimental/export-to-oci-layout/">Export to OCI layout format</a>
</li>
  </ul>
</li>
<li data-nav-id="/docs/features/dockerfiles/" class="dd-item depth-1 collapse">
  <a href="/docs/features/dockerfiles/">Dockerfiles</a>
</li>
<li data-nav-id="/docs/features/reproducibility/" class="dd-item depth-1 collapse">
  <a href="/docs/features/reproducibility/">Reproducibility</a>
</li>
<li data-nav-id="/docs/features/bill-of-materials/" class="dd-item depth-1 collapse">
  <a href="/docs/features/bill-of-materials/">Software Bill of Materials</a>
</li>
  </ul>
</li>
<li data-nav-id="/docs/app-developer-guide/" class="dd-item depth-0 haschildren">
  <a href="/docs/app-developer-guide/">App Developer Guide</a>
  <ul class="ml-2">
<li data-nav-id="/docs/app-developer-guide/build-an-app/" class="dd-item depth-1">
  <a href="/docs/app-developer-guide/build-an-app/">Build an app</a>
</li>
<li data-nav-id="/docs/app-developer-guide/build-a-windows-app/" class="dd-item depth-1">
  <a href="/docs/app-developer-guide/build-a-windows-app/">Build a Windows app</a>
</li>
<li data-nav-id="/docs/app-developer-guide/build-an-arm-app/" class="dd-item depth-1">
  <a href="/docs/app-developer-guide/build-an-arm-app/">Build an ARM app</a>
</li>
<li data-nav-id="/docs/app-developer-guide/environment-variables/" class="dd-item depth-1">
  <a href="/docs/app-developer-guide/environment-variables/">Environment variables</a>
</li>
<li data-nav-id="/docs/app-developer-guide/using-cache-image/" class="dd-item depth-1">
  <a href="/docs/app-developer-guide/using-cache-image/">Cache Images</a>
</li>
<li data-nav-id="/docs/app-developer-guide/mounting-volumes/" class="dd-item depth-1">
  <a href="/docs/app-developer-guide/mounting-volumes/">Mounting Volumes</a>
</li>
<li data-nav-id="/docs/app-developer-guide/specify-buildpacks/" class="dd-item depth-1">
  <a href="/docs/app-developer-guide/specify-buildpacks/">Specify buildpacks</a>
</li>
<li data-nav-id="/docs/app-developer-guide/run-an-app/" class="dd-item depth-1">
  <a href="/docs/app-developer-guide/run-an-app/">Specify launch process</a>
</li>
<li data-nav-id="/docs/app-developer-guide/using-project-descriptor/" class="dd-item depth-1">
  <a href="/docs/app-developer-guide/using-project-descriptor/">Using project.toml</a>
</li>
<li data-nav-id="/docs/app-developer-guide/using-inline-buildpacks/" class="dd-item depth-1">
  <a href="/docs/app-developer-guide/using-inline-buildpacks/">Using Inline Buildpacks</a>
</li>
<li data-nav-id="/docs/app-developer-guide/using-http-proxy/" class="dd-item depth-1">
  <a href="/docs/app-developer-guide/using-http-proxy/">Using Buildpacks with a Proxy</a>
</li>
<li data-nav-id="/docs/app-developer-guide/building-on-podman/" class="dd-item depth-1">
  <a href="/docs/app-developer-guide/building-on-podman/">Building on Podman</a>
</li>
  </ul>
</li>
<li data-nav-id="/docs/buildpack-author-guide/" class="dd-item depth-0 parent haschildren">
  <a href="/docs/buildpack-author-guide/">Buildpack Author Guide</a>
  <ul class="ml-2">
<li data-nav-id="/docs/buildpack-author-guide/create-buildpack/" class="dd-item depth-1 haschildren">
  <a href="/docs/buildpack-author-guide/create-buildpack/">Create a buildpack</a>
  <ul class="ml-2">
<li data-nav-id="/docs/buildpack-author-guide/create-buildpack/setup-local-environment/" class="dd-item depth-2 collapse">
  <a href="/docs/buildpack-author-guide/create-buildpack/setup-local-environment/">Set up your local environment</a>
</li>
<li data-nav-id="/docs/buildpack-author-guide/create-buildpack/building-blocks-cnb/" class="dd-item depth-2 collapse">
  <a href="/docs/buildpack-author-guide/create-buildpack/building-blocks-cnb/">Building blocks of a Cloud Native Buildpack</a>
</li>
<li data-nav-id="/docs/buildpack-author-guide/create-buildpack/detection/" class="dd-item depth-2 collapse">
  <a href="/docs/buildpack-author-guide/create-buildpack/detection/">Detecting your application</a>
</li>
<li data-nav-id="/docs/buildpack-author-guide/create-buildpack/build-app/" class="dd-item depth-2 collapse">
  <a href="/docs/buildpack-author-guide/create-buildpack/build-app/">Building your application</a>
</li>
<li data-nav-id="/docs/buildpack-author-guide/create-buildpack/make-app-runnable/" class="dd-item depth-2 collapse">
  <a href="/docs/buildpack-author-guide/create-buildpack/make-app-runnable/">Make your application runnable</a>
</li>
<li data-nav-id="/docs/buildpack-author-guide/create-buildpack/specify-multiple-process-types/" class="dd-item depth-2 collapse">
  <a href="/docs/buildpack-author-guide/create-buildpack/specify-multiple-process-types/">Specify multiple process types</a>
</li>
<li data-nav-id="/docs/buildpack-author-guide/create-buildpack/caching/" class="dd-item depth-2 collapse">
  <a href="/docs/buildpack-author-guide/create-buildpack/caching/">Improving performance with caching</a>
</li>
<li data-nav-id="/docs/buildpack-author-guide/create-buildpack/make-buildpack-configurable/" class="dd-item depth-2 collapse">
  <a href="/docs/buildpack-author-guide/create-buildpack/make-buildpack-configurable/">Making your buildpack configurable</a>
</li>
<li data-nav-id="/docs/buildpack-author-guide/create-buildpack/adding-bill-of-materials/" class="dd-item depth-2 collapse">
  <a href="/docs/buildpack-author-guide/create-buildpack/adding-bill-of-materials/">Adding Bill-of-Materials</a>
</li>
  </ul>
</li>
<li data-nav-id="/docs/buildpack-author-guide/package-a-buildpack/" class="dd-item depth-1">
  <a href="/docs/buildpack-author-guide/package-a-buildpack/">Package a buildpack</a>
</li>
<li data-nav-id="/docs/buildpack-author-guide/publish-a-buildpack/" class="dd-item depth-1">
  <a href="/docs/buildpack-author-guide/publish-a-buildpack/">Publish a buildpack</a>
</li>
<li data-nav-id="/docs/buildpack-author-guide/publishing-with-github-actions/" class="dd-item depth-1">
  <a href="/docs/buildpack-author-guide/publishing-with-github-actions/">Publishing with Github Actions</a>
</li>
<li data-nav-id="/docs/buildpack-author-guide/caching-strategies/" class="dd-item depth-1">
  <a href="/docs/buildpack-author-guide/caching-strategies/">Layer Types</a>
</li>
<li data-nav-id="/docs/buildpack-author-guide/build-phases-overview/" class="dd-item depth-1 active">
  <a href="/docs/buildpack-author-guide/build-phases-overview/">Overview of Buildpacks Phases</a>
</li>
  </ul>
</li>
<li data-nav-id="/docs/extension-guide/" class="dd-item depth-0 haschildren">
  <a href="/docs/extension-guide/">Extension Guide</a>
  <ul class="ml-2">
<li data-nav-id="/docs/extension-guide/consume-extension/" class="dd-item depth-1 haschildren">
  <a href="/docs/extension-guide/consume-extension/">Consume an extension</a>
  <ul class="ml-2">
<li data-nav-id="/docs/extension-guide/consume-extension/from-cli/" class="dd-item depth-2 collapse">
  <a href="/docs/extension-guide/consume-extension/from-cli/">Specifying an Image Extension at Build Time</a>
</li>
<li data-nav-id="/docs/extension-guide/consume-extension/in-builder/" class="dd-item depth-2 collapse">
  <a href="/docs/extension-guide/consume-extension/in-builder/">Specifying an Image Extension in the Builder</a>
</li>
  </ul>
</li>
<li data-nav-id="/docs/extension-guide/create-extension/" class="dd-item depth-1 haschildren">
  <a href="/docs/extension-guide/create-extension/">Create an extension</a>
  <ul class="ml-2">
<li data-nav-id="/docs/extension-guide/create-extension/setup-local-environment/" class="dd-item depth-2 collapse">
  <a href="/docs/extension-guide/create-extension/setup-local-environment/">Set up your local environment</a>
</li>
<li data-nav-id="/docs/extension-guide/create-extension/why-dockerfiles/" class="dd-item depth-2 collapse">
  <a href="/docs/extension-guide/create-extension/why-dockerfiles/">Why Dockerfiles</a>
</li>
<li data-nav-id="/docs/extension-guide/create-extension/building-blocks-extension/" class="dd-item depth-2 collapse">
  <a href="/docs/extension-guide/create-extension/building-blocks-extension/">Building blocks of a CNB Image Extension</a>
</li>
<li data-nav-id="/docs/extension-guide/create-extension/build-dockerfile/" class="dd-item depth-2 collapse">
  <a href="/docs/extension-guide/create-extension/build-dockerfile/">Generating a build.Dockerfile</a>
</li>
<li data-nav-id="/docs/extension-guide/create-extension/run-dockerfile-switch/" class="dd-item depth-2 collapse">
  <a href="/docs/extension-guide/create-extension/run-dockerfile-switch/">Generating a run.Dockerfile that switches the runtime base image</a>
</li>
<li data-nav-id="/docs/extension-guide/create-extension/run-dockerfile-extend/" class="dd-item depth-2 collapse">
  <a href="/docs/extension-guide/create-extension/run-dockerfile-extend/">Generating a run.Dockerfile that extends the runtime base image</a>
</li>
  </ul>
</li>
  </ul>
</li>
<li data-nav-id="/docs/operator-guide/" class="dd-item depth-0 haschildren">
  <a href="/docs/operator-guide/">Operator Guide</a>
  <ul class="ml-2">
<li data-nav-id="/docs/operator-guide/create-a-builder/" class="dd-item depth-1">
  <a href="/docs/operator-guide/create-a-builder/">Create a builder</a>
</li>
<li data-nav-id="/docs/operator-guide/create-a-stack/" class="dd-item depth-1">
  <a href="/docs/operator-guide/create-a-stack/">Create a stack</a>
</li>
  </ul>
</li>
<li data-nav-id="/docs/platform-guide/" class="dd-item depth-0 haschildren">
  <a href="/docs/platform-guide/">Platform Guide</a>
  <ul class="ml-2">
<li data-nav-id="/docs/platform-guide/conventions/" class="dd-item depth-1 haschildren">
  <a href="/docs/platform-guide/conventions/">Conventions</a>
  <ul class="ml-2">
<li data-nav-id="/docs/platform-guide/conventions/source-metadata/" class="dd-item depth-2 collapse">
  <a href="/docs/platform-guide/conventions/source-metadata/">Source Metadata</a>
</li>
  </ul>
</li>
  </ul>
</li>
<li data-nav-id="/docs/tools/" class="dd-item depth-0 haschildren">
  <a href="/docs/tools/">Tools</a>
  <ul class="ml-2">
<li data-nav-id="/docs/tools/pack/" class="dd-item depth-1 haschildren">
  <a href="/docs/tools/pack/">Pack</a>
  <ul class="ml-2">
<li data-nav-id="/docs/tools/pack/concepts/" class="dd-item depth-2 collapse haschildren">
  <a href="/docs/tools/pack/concepts/">Concepts</a>
  <ul class="ml-2">
<li data-nav-id="/docs/tools/pack/concepts/trusted_builders/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/concepts/trusted_builders/">Trusted Builders</a>
</li>
  </ul>
</li>
<li data-nav-id="/docs/tools/pack/cli/" class="dd-item depth-2 collapse haschildren">
  <a href="/docs/tools/pack/cli/">CLI Docs</a>
  <ul class="ml-2">
<li data-nav-id="/docs/tools/pack/cli/pack/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack/">pack</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_build/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_build/">pack build</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_builder/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_builder/">pack builder</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_builder_create/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_builder_create/">pack builder create</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_builder_inspect/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_builder_inspect/">pack builder inspect</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_builder_suggest/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_builder_suggest/">pack builder suggest</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_buildpack/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_buildpack/">pack buildpack</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_buildpack_inspect/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_buildpack_inspect/">pack buildpack inspect</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_buildpack_new/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_buildpack_new/">pack buildpack new</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_buildpack_package/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_buildpack_package/">pack buildpack package</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_buildpack_pull/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_buildpack_pull/">pack buildpack pull</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_buildpack_register/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_buildpack_register/">pack buildpack register</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_buildpack_yank/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_buildpack_yank/">pack buildpack yank</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_completion/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_completion/">pack completion</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_config/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_config/">pack config</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_config_default-builder/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_config_default-builder/">pack config default-builder</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_config_experimental/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_config_experimental/">pack config experimental</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_config_lifecycle-image/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_config_lifecycle-image/">pack config lifecycle-image</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_config_pull-policy/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_config_pull-policy/">pack config pull-policy</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_config_registries/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_config_registries/">pack config registries</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_config_registries_add/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_config_registries_add/">pack config registries add</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_config_registries_default/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_config_registries_default/">pack config registries default</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_config_registries_list/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_config_registries_list/">pack config registries list</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_config_registries_remove/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_config_registries_remove/">pack config registries remove</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_config_registry-mirrors/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_config_registry-mirrors/">pack config registry-mirrors</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_config_registry-mirrors_add/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_config_registry-mirrors_add/">pack config registry-mirrors add</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_config_registry-mirrors_list/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_config_registry-mirrors_list/">pack config registry-mirrors list</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_config_registry-mirrors_remove/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_config_registry-mirrors_remove/">pack config registry-mirrors remove</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_config_run-image-mirrors/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_config_run-image-mirrors/">pack config run-image-mirrors</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_config_run-image-mirrors_add/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_config_run-image-mirrors_add/">pack config run-image-mirrors add</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_config_run-image-mirrors_list/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_config_run-image-mirrors_list/">pack config run-image-mirrors list</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_config_run-image-mirrors_remove/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_config_run-image-mirrors_remove/">pack config run-image-mirrors remove</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_config_trusted-builders/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_config_trusted-builders/">pack config trusted-builders</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_config_trusted-builders_add/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_config_trusted-builders_add/">pack config trusted-builders add</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_config_trusted-builders_list/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_config_trusted-builders_list/">pack config trusted-builders list</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_config_trusted-builders_remove/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_config_trusted-builders_remove/">pack config trusted-builders remove</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_extension/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_extension/">pack extension</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_extension_inspect/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_extension_inspect/">pack extension inspect</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_extension_new/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_extension_new/">pack extension new</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_extension_package/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_extension_package/">pack extension package</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_extension_pull/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_extension_pull/">pack extension pull</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_extension_register/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_extension_register/">pack extension register</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_extension_yank/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_extension_yank/">pack extension yank</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_inspect/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_inspect/">pack inspect</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_rebase/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_rebase/">pack rebase</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_report/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_report/">pack report</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_sbom/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_sbom/">pack sbom</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_sbom_download/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_sbom_download/">pack sbom download</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_stack/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_stack/">pack stack</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_stack_suggest/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_stack_suggest/">pack stack suggest</a>
</li>
<li data-nav-id="/docs/tools/pack/cli/pack_version/" class="dd-item depth-3 collapse">
  <a href="/docs/tools/pack/cli/pack_version/">pack version</a>
</li>
  </ul>
</li>
  </ul>
</li>
<li data-nav-id="/docs/tools/circleci/" class="dd-item depth-1">
  <a href="/docs/tools/circleci/">CircleCI</a>
</li>
<li data-nav-id="/docs/tools/gitlab/" class="dd-item depth-1">
  <a href="/docs/tools/gitlab/">Gitlab Auto DevOps</a>
</li>
<li data-nav-id="/docs/tools/kpack/" class="dd-item depth-1">
  <a href="/docs/tools/kpack/">kpack</a>
</li>
<li data-nav-id="/docs/tools/piper/" class="dd-item depth-1">
  <a href="/docs/tools/piper/">Project &ldquo;Piper&rdquo;</a>
</li>
<li data-nav-id="/docs/tools/tekton/" class="dd-item depth-1">
  <a href="/docs/tools/tekton/">Tekton</a>
</li>
  </ul>
</li>
<li data-nav-id="/docs/reference/" class="dd-item depth-0 haschildren">
  <a href="/docs/reference/">Reference</a>
  <ul class="ml-2">
<li data-nav-id="/docs/reference/config/" class="dd-item depth-1 collapse haschildren">
  <a href="/docs/reference/config/">Configuration</a>
  <ul class="ml-2">
<li data-nav-id="/docs/reference/config/builder-config/" class="dd-item depth-2 collapse">
  <a href="/docs/reference/config/builder-config/">builder.toml</a>
</li>
<li data-nav-id="/docs/reference/config/package-config/" class="dd-item depth-2 collapse">
  <a href="/docs/reference/config/package-config/">package.toml</a>
</li>
<li data-nav-id="/docs/reference/config/project-descriptor/" class="dd-item depth-2 collapse">
  <a href="/docs/reference/config/project-descriptor/">project.toml</a>
</li>
  </ul>
</li>
<li data-nav-id="/docs/reference/spec/" class="dd-item depth-1 collapse haschildren">
  <a href="/docs/reference/spec/">Specification</a>
  <ul class="ml-2">
<li data-nav-id="/docs/reference/spec/buildpack-api/" class="dd-item depth-2">
  <a href="/docs/reference/spec/buildpack-api/">Buildpack API</a>
</li>
<li data-nav-id="/docs/reference/spec/distribution-api/" class="dd-item depth-2">
  <a href="/docs/reference/spec/distribution-api/">Distribution API</a>
</li>
<li data-nav-id="/docs/reference/spec/migration/" class="dd-item depth-2 haschildren">
  <a href="/docs/reference/spec/migration/">Migration</a>
  <ul class="ml-2">
<li data-nav-id="/docs/reference/spec/migration/buildpack-api-0.4-0.5/" class="dd-item depth-3 collapse">
  <a href="/docs/reference/spec/migration/buildpack-api-0.4-0.5/">Buildpack API 0.4 -&gt; 0.5</a>
</li>
<li data-nav-id="/docs/reference/spec/migration/buildpack-api-0.5-0.6/" class="dd-item depth-3 collapse">
  <a href="/docs/reference/spec/migration/buildpack-api-0.5-0.6/">Buildpack API 0.5 -&gt; 0.6</a>
</li>
<li data-nav-id="/docs/reference/spec/migration/buildpack-api-0.6-0.7/" class="dd-item depth-3 collapse">
  <a href="/docs/reference/spec/migration/buildpack-api-0.6-0.7/">Buildpack API 0.6 -&gt; 0.7</a>
</li>
<li data-nav-id="/docs/reference/spec/migration/buildpack-api-0.7-0.8/" class="dd-item depth-3 collapse">
  <a href="/docs/reference/spec/migration/buildpack-api-0.7-0.8/">Buildpack API 0.7 -&gt; 0.8</a>
</li>
<li data-nav-id="/docs/reference/spec/migration/buildpack-api-0.8-0.9/" class="dd-item depth-3 collapse">
  <a href="/docs/reference/spec/migration/buildpack-api-0.8-0.9/">Buildpack API 0.8 -&gt; 0.9</a>
</li>
<li data-nav-id="/docs/reference/spec/migration/platform-api-0.3-0.4/" class="dd-item depth-3 collapse">
  <a href="/docs/reference/spec/migration/platform-api-0.3-0.4/">Platform API 0.3 -&gt; 0.4</a>
</li>
<li data-nav-id="/docs/reference/spec/migration/platform-api-0.4-0.5/" class="dd-item depth-3 collapse">
  <a href="/docs/reference/spec/migration/platform-api-0.4-0.5/">Platform API 0.4 -&gt; 0.5</a>
</li>
<li data-nav-id="/docs/reference/spec/migration/platform-api-0.5-0.6/" class="dd-item depth-3 collapse">
  <a href="/docs/reference/spec/migration/platform-api-0.5-0.6/">Platform API 0.5 -&gt; 0.6</a>
</li>
<li data-nav-id="/docs/reference/spec/migration/platform-api-0.6-0.7/" class="dd-item depth-3 collapse">
  <a href="/docs/reference/spec/migration/platform-api-0.6-0.7/">Platform API 0.6 -&gt; 0.7</a>
</li>
<li data-nav-id="/docs/reference/spec/migration/platform-api-0.7-0.8/" class="dd-item depth-3 collapse">
  <a href="/docs/reference/spec/migration/platform-api-0.7-0.8/">Platform API 0.7 -&gt; 0.8</a>
</li>
<li data-nav-id="/docs/reference/spec/migration/platform-api-0.8-0.9/" class="dd-item depth-3 collapse">
  <a href="/docs/reference/spec/migration/platform-api-0.8-0.9/">Platform API 0.8 -&gt; 0.9</a>
</li>
<li data-nav-id="/docs/reference/spec/migration/platform-api-0.9-0.10/" class="dd-item depth-3 collapse">
  <a href="/docs/reference/spec/migration/platform-api-0.9-0.10/">Platform API 0.9 -&gt; 0.10</a>
</li>
  </ul>
</li>
<li data-nav-id="/docs/reference/spec/platform-api/" class="dd-item depth-2">
  <a href="/docs/reference/spec/platform-api/">Platform API</a>
</li>
  </ul>
</li>
  </ul>
</li>
  </ul>
  
</nav>



      </div>
      <div class='col-md-9 docs-content'>
        <div class="support-links text-right">
  
    
    
    <a href="https://github.com/buildpacks/docs/issues/new?body=%2A%2AOn&#43;Page%3A%2A%2A&#43;%5BOverview&#43;of&#43;Buildpacks&#43;Phases%5D%28https%3A%2F%2Fbuildpacks.io%2Fdocs%2Fbuildpack-author-guide%2Fbuild-phases-overview%2F%29"
       class="button-light button-small icon-button blank bg-white inline-flex" target="_blank">Report Issue</a>

    
    
    <a href="https://github.com/buildpacks/docs/edit/main/content/docs/buildpack-author-guide/build-phases-overview.md?description=Signed-off-by%3A&#43;NAME&#43;%3CEMAIL_ADDRESS%3E%0A%0A%3E&#43;_By&#43;signing&#43;off&#43;you&#43;acknowledge&#43;adhering&#43;to&#43;the&#43;requirements&#43;listed&#43;here%3A&#43;https%3A%2F%2Fprobot.github.io%2Fapps%2Fdco%2F_"
       class="button-light button-small icon-button github-button bg-white inline-flex" target="_blank">Edit</a>
    
  
</div>


        <div class="heading">
          <h1 class="title">Overview of Buildpacks Phases</h1>
        </div>

        <p>We work through a full example of building a &ldquo;hello world&rdquo; NodeJs web application.  In the example we run <code>pack</code> on the NodeJS application to produce an application image.  We assume that we have a NodeJS buildpack, <code>registry.fake/buildpacks/nodejs:latest</code>, that is decomposed into buildpacks that help with the build.  We expand each of the buildpacks phases to explain the process.  Throughout the example we take a production-level view of their operation.  For example, our assumed NodeJS buildpack will be described to create different build, cache and launch layers in a manner similar to how a real NodeJS buildpack would operate.</p>
<h2 id="nodejs-buildpack">NodeJS buildpack</h2>
<p>The example NodeJS buildpack is a meta-buildpack.  It is composed of</p>
<ul>
<li><code>node-engine</code> buildpack that provides the <code>node</code> and <code>npm</code> binaries,</li>
<li><code>yarn</code> buildpack that provides the <code>yarn</code> binary,</li>
<li><code>yarn-install</code> and <code>npm-install</code> buildpacks that install dependencies using either <code>yarn</code> or <code>npm</code>,</li>
<li><code>yarn-start</code> and <code>npm-start</code> buildpacks that configure the entrypoint to the application image,</li>
<li><code>procfile</code> a buildpack that allows developers to provide a <a href="https://devcenter.heroku.com/articles/procfile#procfile-format">Heroku-style</a> entrypoint for the image.</li>
</ul>
<p>The <code>nodejs</code> buildpack itself is a meta-buildpack which defines two <strong>order groups</strong>.  Here we represent the order groups visually:</p>
<p><img src="/images/order-groups.svg" alt="nodejs order groups"></p>
<p>The order group containing <code>yarn</code> logic has higher precedence in the <code>nodejs</code> buildpack than the order group containing <code>npm-install</code>.  In both order groups the <code>procfile</code> buildpack is optional.  The function of order groups will become more clear as we proceed through our example.</p>
<h2 id="running-pack">Running <code>pack</code></h2>
<p>Our example NodeJS application is a &ldquo;hello world&rdquo; REST-like API.  Any request to the <code>/</code> URL results in the response <code>{&quot;message&quot;, &quot;Hello world&quot;}</code>.  Our application contains the two source files</p>
<pre tabindex="0"><code class="language-command" data-lang="command">$ tree .
.
├── index.js
└── package.json

0 directories, 2 files
</code></pre><p>The core logic is contained in <code>index.js</code>, our dependencies are declared in <code>package.json</code> and <code>package.json</code> also describes how to start our application.  The logic in <code>index.js</code> listens on a <code>PORT</code>, provided as an environment variable:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">({</span><span class="s1">&#39;message&#39;</span><span class="o">:</span> <span class="s1">&#39;Hello World&#39;</span><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">port</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">PORT</span> <span class="o">||</span> <span class="s1">&#39;8080&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">port</span><span class="p">)</span>
</span></span></code></pre></div><p>The dependencies are provided using the mechanism an NodeJS developer expects.  In this example we depend upon <code>express</code> to provide a framework for our REST-like service.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;hello-world&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;version&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;A hello-world nodejs example&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;main&#34;</span><span class="p">:</span> <span class="s2">&#34;index.js&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;scripts&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;start&#34;</span><span class="p">:</span> <span class="s2">&#34;node index.js&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;dependencies&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;express&#34;</span><span class="p">:</span> <span class="s2">&#34;^4.18.1&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Finally, we describe the container entrypoint using a script in the <code>package.json</code>.  The script must be named <code>start</code> according to NodeJS convention.   Here we see that the entrypoint should run the provided <code>node index.js</code> command.</p>
<p>We build our application using the default builder and specify to only use the <code>nodejs</code> meta-buildpack in the build.  The restriction to use only the <code>nodejs</code> meta-buildpack simplifies the explanation as that buildpack provides only two order groups.</p>
<p><asciinema-player
idle-time-limit="0.5s"
font-size="medium"
poster="data:text/plain,$ pack build example --verbose --buildpack docker://registry.fake/buildpacks/nodejs:latest" src="/images/pack-hello-world-nodejs.cast"></asciinema-player></p>
<p>Now that we understand the example application we can step through each of the Buildpack phases.</p>
<h2 id="phases">Phases</h2>
<p>There are five phases to a buildpacks build.  These logic for each phase is provided by a binary within <a href="https://github.com/buildpacks/lifecycle"><code>lifecycle</code></a> and the orchestration of running each of the binaries is the responsibility of the Buildpacks platform.  In this case we are using <code>pack</code> as our Buildpacks platform.</p>
<p>At a high-level each layer:</p>
<ul>
<li>Analyze phase - Reads metadata from any previously built image and ensures we have access to the OCI registry to be able to write the image we will build.</li>
<li>Detect phase - Chooses buildpacks (via /bin/detect) and produces a build plan.</li>
<li>Restore phase - Restores layer metadata from the previous image and from the cache, and restores cached layers.</li>
<li>Build phase - Executes buildpacks (via /bin/build).</li>
<li>Export phase - Creates an image and caches layers.</li>
</ul>
<p>We consider each of the buildpacks phases in the context of our invocation of <code>pack build example --buildpack docker://registry.fake/buildpacks/nodejs:latest</code>.</p>
<h3 id="phase-1-analyze">Phase 1: Analyze</h3>
<p>The analyze phase checks a registry for previous images called <code>example</code>.  It resolves the image metadata making it available to the subsequent restore phase.  In addition, analyze verifies that we have write access to the registry to create or update the image called <code>example</code>.</p>
<p>In our case <code>pack</code> tells us that there is no previous <code>example</code> image.  It provides the output.</p>
<pre tabindex="0"><code>Previous image with name &#34;example&#34; not found
Analyzing image &#34;98070ee549c522cbc08d15683d134aa0af1817fcdc56f450b07e6b4a7903f9b
0&#34;
</code></pre><p>The analyze phase writes to disk the metadata it has found.  The metadata is used by the restore phase when restoring cached image layers.</p>
<h3 id="phase-2-detect">Phase 2: Detect</h3>
<p>The detect phase runs the <code>detect</code> binary of each buildpack in the order provided in the buildpack metadata.</p>
<p>The invocation of <code>pack build example --buildpack docker://registry.fake/buildpacks/nodejs:latest</code> explicitly defines a buildpack order.  The command line invocation includes a single <code>nodejs</code> buildpack.   In our example the detect phase runs the <code>detect</code> binary from each buildpack in the first order group.  The <code>yarn-install</code> <code>detect</code> binary will fail as no yarn lock file is present in our source project.  As the <code>detect</code> binary of a non-optional buildpack has failed, then detection of the entire build group containing <code>yarn-install</code> has failed.  The detect phase then proceeds to run the <code>detect</code> binary of each buildpack in the second order group.  As all non-optional buildpacks in this group have passed the detect phase, all the passing buildpacks are added to the build order.</p>
<p><img src="/images/order-groups-detect.svg" alt="nodejs order groups"></p>
<!-- ALERT-NOTE -->
<blockquote>
<p>The <a href="https://github.com/buildpacks/spec/blob/main/buildpack.md#order-resolution">specification for order resolution</a> shows each order group as a matrix and the resolution as an operation on matrices.</p>
</blockquote>
<p>The above diagram shows that the <code>detect</code> binary of each required buildpack in the second order group passes.  The detect phase is summarized by pack as</p>
<pre tabindex="0"><code>===&gt; DETECTING
======== Output: example/yarn-install@0.0.2 ========
failed
======== Output: example/yarn-start@0.0.3 ========
failed
======== Results ========
pass: example/node-engine@0.0.5
pass: example/yarn@0.0.3
fail: example/yarn-install@0.0.2
fail: example/yarn-start@0.0.3
skip: example/procfile@0.0.2
======== Results ========
pass: example/node-engine@0.0.5
pass: example/npm-install@0.0.2
pass: example/npm-start@0.0.2
skip: example/procfile@0.0.2
Resolving plan... (try #1)
fail: example/npm-install@0.0.2 requires npm
Resolving plan... (try #2)
3 of 4 buildpacks participating
example/node-engine 0.0.5
example/npm-install 0.0.2
example/npm-start   0.0.2
</code></pre><p>The output of the detect phase includes a <strong>build plan</strong>.</p>
<blockquote>
<p>The build plan is a toml file containing declarations of what each buildpack provides and what it requires.</p>
</blockquote>
<p>For example, the <code>example/node-engine</code> buildpack will contribute metadata stating that it provides <code>node</code>.  In addition, it declares a requirement for the subsequent build phase to satisfy the <code>node</code> with some specific metadata.  That is to say, it requires that the build phase installs a node 14.17.5 runtime.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-toml" data-lang="toml"><span class="line"><span class="cl"><span class="p">[[</span><span class="nx">provides</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">    <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;node&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[[</span><span class="nx">requires</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">    <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;node&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nx">requires</span><span class="p">.</span><span class="nx">metadata</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nx">version</span> <span class="p">=</span> <span class="s2">&#34;14.17.5&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">version-source</span> <span class="p">=</span> <span class="s2">&#34;14.17.5&#34;</span>
</span></span></code></pre></div><p>The <code>npm-install</code> <code>detect</code> binary contributes more metadata to the build plan. <code>npm-install</code> requires that a node runtime available.  We will find that the <code>example/node-engine</code> buildpack will satisfy that requirement.  <code>npm-install</code> also requires that the build phase satisfies the <code>npm</code> requirement.  It is interesting to note that the <code>npm-install</code> detect phase attaches additional <code>build = true</code> metadata to each of its requirements.  We will see that this is interpreted by the build phase as the <code>node</code> runtime and <code>npm</code> install process contributing <strong>build layers</strong> i.e. as layers that are available to subsequent buildpacks for the purposes of building the application.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-toml" data-lang="toml"><span class="line"><span class="cl"><span class="p">[[</span><span class="nx">provides</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">   <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;npm&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[[</span><span class="nx">requires</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">    <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;node&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nx">requires</span><span class="p">.</span><span class="nx">metadata</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nx">build</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">requires</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;npm&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nx">entries</span><span class="p">.</span><span class="nx">requires</span><span class="p">.</span><span class="nx">metadata</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nx">build</span> <span class="p">=</span> <span class="kc">true</span>
</span></span></code></pre></div><p>The <code>detect</code> binary of <code>npm-start</code> detects the existence of a <code>start</code> command within <code>package.json</code>.  If such a command exists it contributes requirements to the build plan that require <code>node</code> and <code>npm</code> to be available within a <strong>launch layer</strong> i.e. as layers in the output image.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-toml" data-lang="toml"><span class="line"><span class="cl"><span class="p">[[</span><span class="nx">requires</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">    <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;node&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nx">requires</span><span class="p">.</span><span class="nx">metadata</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nx">launch</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[[</span><span class="nx">requires</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">    <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;npm&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nx">requires</span><span class="p">.</span><span class="nx">metadata</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nx">launch</span> <span class="p">=</span> <span class="kc">true</span>
</span></span></code></pre></div><p>The build plans provided by each <code>detect</code> binary are resolved as an output of the detect phase.  The detect phase can fail if a buildpack requires a dependency that cannot be resolved.</p>
<p>We have provided a complete example of the detect phase for our &ldquo;hello world&rdquo; NodeJS application.  Given input application code and buildpacks, the output is largely a declarative TOML file passed to the build phase.  The detected order is written to a <code>group.toml</code> file which is used in the restore phase.</p>
<h3 id="phase-3-restore">Phase 3: Restore</h3>
<p>The restore phase uses metadata provided by the analyze phase and <code>group.toml</code> from the detect phase.  It outputs cached layers to <code>$CNB_LAYERS_DIR/&lt;buildpack-id&gt;</code> in the application image.  If a layer is restored at the restore phase then we skip the build phase for that layer.</p>
<p>In our running example there is no previous build.  The analyze phase returned no cached image.  Therefore the restore phase is similarly quiet and <code>pack</code> outputs the following:</p>
<pre tabindex="0"><code>===&gt; RESTORING
Reading buildpack directory: /layers/example_node-engine
Not restoring &#34;example/node-engine:node&#34; from cache, marked as launch=true
Reading buildpack directory: /layers/example_npm-install
Not restoring &#34;example/npm-install:modules&#34; from cache, marked as launch=true
Not restoring &#34;example/npm-install:npm-cache&#34; from cache, marked as launch=true
Reading buildpack directory: /layers/example_npm-start
Reading buildpack directory: /layers/example_procfile
Reading buildpack directory: /layers/example_node-engine
Reading buildpack directory: /layers/example_npm-install
Reading buildpack directory: /layers/example_npm-start
Reading buildpack directory: /layers/example_procfile
</code></pre><p>Having resolved the build plan and any cached layers, the build phase can concentrate on creating layers.</p>
<h3 id="phase-4-build">Phase 4: Build</h3>
<p>The build phase is provided as input the order in which to run the buildpacks (<code>group.toml</code>) and the build plan (<code>plan.toml</code>).  The build phase runs the <code>build</code> binary of each buildpack.  The build binary for a buildpack outputs zero or more layers into <code>$(CNB_LAYERS_DIR)/&lt;buildpack-id&gt;</code> and writes metadata for each layer as TOML files in that directory.  Buildpacks should also provide Software Bill-of-Materials for each layer that they contribute to the build.</p>
<p>In our running NodeJS example the build phase runs the <code>build</code> binary from the</p>
<ul>
<li><code>example/node-engine</code> buildpack, followed by</li>
<li><code>example/node-install</code>, followed by</li>
<li><code>example/node-start</code>, and finally</li>
<li><code>example/procfile</code>.</li>
</ul>
<p>In this example, each buildpack contributes a single layer to the output image.</p>
<p>Each invocation of <code>build</code> is passed a <strong>buildpack plan</strong> specific to each buildpack.  The buildpack plan are those entries from the build plan that reference something provided by that buildpack.</p>
<h4 id="node-engine-build-execution"><code>node-engine</code> build execution</h4>
<p>The <code>example/node-engine</code> buildpack provides <code>node</code>.  Therefore all entries in the build plan that require <code>node</code> are passed in the buildpack plan for this buildpack.  The buildpack plan provided to <code>example/node-engine</code> in this example is</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-toml" data-lang="toml"><span class="line"><span class="cl"><span class="p">[[</span><span class="nx">entries</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">    <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;node&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">entries</span><span class="p">.</span><span class="nx">metadata</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="nx">version</span> <span class="p">=</span> <span class="s2">&#34;14.17.5&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">version-source</span> <span class="p">=</span> <span class="s2">&#34;14.17.5&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">entries</span><span class="p">.</span><span class="nx">metadata</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="nx">build</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">entries</span><span class="p">.</span><span class="nx">metadata</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="nx">launch</span> <span class="p">=</span> <span class="kc">true</span>
</span></span></code></pre></div><p>Given the metadata from the buildpack plan, an archive containing <code>node</code> version <code>14.17.5</code> is fetched from a network source and expanded as a layer contributed by this buildpack.</p>
<pre tabindex="0"><code>===&gt; BUILDING
Starting build
Running build for buildpack example/node-engine@0.0.5
Looking up buildpack
Finding plan
Running build for buildpack node-engine 0.0.5
Creating plan directory
Preparing paths
Running build command
node-engine 0.0.5
  Resolving Node Engine version
    Candidate version sources (in priority order):
                -&gt; &#34;&#34;
      &lt;unknown&gt; -&gt; &#34;&#34;

    Selected Node Engine version (using ): 14.17.5

  Executing build process
    Installing Node Engine 14.17.5
      Completed in 31.715s

  Configuring build environment
    NODE_ENV     -&gt; &#34;production&#34;
    NODE_HOME    -&gt; &#34;/layers/example_node-engine/node&#34;
    NODE_VERBOSE -&gt; &#34;false&#34;

  Configuring launch environment
    NODE_ENV     -&gt; &#34;production&#34;
    NODE_HOME    -&gt; &#34;/layers/example_node-engine/node&#34;
    NODE_VERBOSE -&gt; &#34;false&#34;

    Writing profile.d/0_memory_available.sh
      Calculates available memory based on container limits at launch time.
      Made available in the MEMORY_AVAILABLE environment variable.

Processing layers
Updating environment
Reading output files
Updating buildpack processes
Updating process list
Finished running build for buildpack example/node-engine@0.0.5
</code></pre><p>The <code>node-engine</code> buildpack contributes a layer containing <code>bin/node</code>, the supporting libraries for <code>bin/node</code> and sets environment variables that are specific to the node binary.</p>
<h4 id="npm-install-build-execution"><code>npm-install</code> build execution</h4>
<p>The <code>npm-install</code> buildpack contributes at least two layers.  One layer is a cache-only layer and is never exported as part of the application image.  The cache layer holds <code>npm</code> metadata and the installed <code>node_modules</code>.  If <code>npm</code> is also required to provide a launch layer, as it is in our running example, then the <code>node_modules</code> of the cache layer are provided as a layer in the application image.  In addition, a script is provided to set up some symlinks.  The script executes on container startup ensuring that our <code>index.js</code> can resolve JavaScript modules installed in the layer.</p>
<pre tabindex="0"><code>Running build for buildpack example/npm-install@0.0.2
Looking up buildpack
Finding plan
Running build for buildpack npm-install 0.0.2
Creating plan directory
Preparing paths
Running build command
npm-install 0.0.2
  Resolving installation process
    Process inputs:
      node_modules      -&gt; &#34;Not found&#34;
      npm-cache         -&gt; &#34;Not found&#34;
      package-lock.json -&gt; &#34;Found&#34;

    Selected NPM build process: &#39;npm ci&#39;

  Executing build process
    Running &#39;npm ci --unsafe-perm --cache /layers/example_npm-install/npm-cache&#39;
      Completed in 11.255s

  Configuring launch environment
    NPM_CONFIG_LOGLEVEL -&gt; &#34;error&#34;

  Configuring environment shared by build and launch
    PATH -&gt; &#34;$PATH:/layers/example_npm-install/modules/node_modules/.bin&#34;


Processing layers
Updating environment
Reading output files
Updating buildpack processes
Updating process list
Finished running build for buildpack example/npm-install@0.0.2
</code></pre><p>In the verbose output of an execution of <code>npm-install</code>&rsquo;s <code>build</code> binary we can observe that the <code>NPM_CONFIG_LOGLEVEL</code> environment variable is set on the application image and the <code>PATH</code> environmental variable is extended so that binaries installed via <code>npm</code> can be found.</p>
<h4 id="npm-start-build-execution"><code>npm-start</code> build execution</h4>
<p>The <code>npm-start</code> build phase creates an entrypoint in the application image.</p>
<pre tabindex="0"><code>Running build for buildpack example/npm-start@0.0.2
Looking up buildpack
Finding plan
Running build for buildpack npm-start 0.0.2
Creating plan directory
Preparing paths
Running build command
npm-start 0.0.2
  Assigning launch processes
    web: node index.js

Processing layers
Updating environment
Reading output files
Updating buildpack processes
Updating process list
Finished running build for buildpack example/npm-start@0.0.2
</code></pre><p>The output layers contributed by each buildpack are then exported as an OCI image.</p>
<h3 id="phase-5-export">Phase 5: Export</h3>
<p>The export phase constructs a new OCI image using all the layers provided in the build phase.  In addition the application source is added as a layer to the output image and the image <code>ENTRYPOINT</code> is set.  The exported image, which we call <code>example</code>, contains only launch layers.  Cache layers are preserved on the local machine for subsequent builds.</p>
<p>Our NodeJS example image requires an entrypoint called <code>web</code>.  The <code>web</code> entrypoint is implemented on the application image as a symlink to the <code>launcher</code> binary.  As we have specified a single entrypoint, this then becomes the default entrypoint of the image.</p>
<h2 id="summary">Summary</h2>
<p>We have taken a detailed look at how buildpacks are used to build a sample application.  The meta-buildpack contains two order groups and we have seen examples of how an order group is resolved.  In addition we have looked at the contributions that a buildpack makes to the build plan and considered how these are resolved into a buildpack plan to be provided to the build phase of specific buildpacks.  Finally, we have briefly considered how the analyze and restore phases can allow advanced caching strategies.</p>


        

        <hr>
<div class='footline d-block'>
  <div class="support-links text-right">
  
    
    
    <a href="https://github.com/buildpacks/docs/issues/new?body=%2A%2AOn&#43;Page%3A%2A%2A&#43;%5BOverview&#43;of&#43;Buildpacks&#43;Phases%5D%28https%3A%2F%2Fbuildpacks.io%2Fdocs%2Fbuildpack-author-guide%2Fbuild-phases-overview%2F%29"
       class="button-light button-small icon-button blank bg-white inline-flex" target="_blank">Report Issue</a>

    
    
    <a href="https://github.com/buildpacks/docs/edit/main/content/docs/buildpack-author-guide/build-phases-overview.md?description=Signed-off-by%3A&#43;NAME&#43;%3CEMAIL_ADDRESS%3E%0A%0A%3E&#43;_By&#43;signing&#43;off&#43;you&#43;acknowledge&#43;adhering&#43;to&#43;the&#43;requirements&#43;listed&#43;here%3A&#43;https%3A%2F%2Fprobot.github.io%2Fapps%2Fdco%2F_"
       class="button-light button-small icon-button github-button bg-white inline-flex" target="_blank">Edit</a>
    
  
</div>

</div>

      </div>
    </div>
  </div>
</div>





  <footer>
  <div class="container footer">
    <a href="https://www.cncf.io/" style="width: 50%;"><img src="/images/cncf-color.svg" class="footer-logo" alt="CNCF logo" ></a>
    <p>We are a <a href="https://www.cncf.io/">Cloud Native Computing Foundation</a> incubating project.</p>
  </div>
  <div class="bg-blue">
    <div class="container sub-footer">
      <ul>
        
        <li><a target="_blank" rel="noopener noreferrer" href="https://buildpacks.devstats.cncf.io/d/8/dashboards?orgId=1&amp;refresh=15m">DevStats</a></li>
        
        <li><span>&bull;</span><a target="_blank" rel="noopener noreferrer" href="https://datastudio.google.com/reporting/4b23856c-6c24-44f5-86f2-333d0ad3f236">Analytics</a></li>
        
        <li><span>&bull;</span><a target="_blank" rel="noopener noreferrer" href="https://www.linuxfoundation.org/privacy/">Privacy Policy</a></li>
        
      </ul>

      <ul>
        
        <li><a target="_blank" rel="noopener noreferrer" href="https://lists.cncf.io/g/cncf-buildpacks/join">Mailing List</a></li>
        
        <li><span>&bull;</span><a target="_blank" rel="noopener noreferrer" href="https://slack.cncf.io">Slack</a></li>
        
        <li><span>&bull;</span><a target="_blank" rel="noopener noreferrer" href="https://twitter.com/buildpacks_io">Twitter</a></li>
        
        <li><span>&bull;</span><a target="_blank" rel="noopener noreferrer" href="https://github.com/buildpacks">GitHub</a></li>
        
      </ul>
    </div>
    <div class="container sub-footer">
      <ul>
        <li><p>Copyright © 2022 The Linux Foundation ®. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href="(https://www.linuxfoundation.org/trademark-usage">Trademark Usage page</a></p></li>
      </ul>
    </div>
  </div>
</footer>


    
  <script src="https://cdnjs.cloudflare.com/ajax/libs/asciinema-player/2.6.1/asciinema-player.min.js"></script>
</body>

</html>
